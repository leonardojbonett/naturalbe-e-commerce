(()=>{let t=[];Object.defineProperty(window,"cart",{get:()=>t,set:e=>{Array.isArray(e),t=e},configurable:!0});let e="all",n="all",o="",i={},a="featured";const r=!1!==window.NB_MINI_CART_ENABLED;let c=null,s=null;function d(t){return String(t||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}const l=`${window.NB_BASE_PATH||"./"}static/img/placeholder.webp`;let u=null;const m="naturalbe_cart",p=()=>{try{return window.localStorage||window.sessionStorage||null}catch(t){return null}},f=t=>String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),g=t=>{const e=String(t||"");return/^\s*javascript:/i.test(e)?"#":e},y=t=>f((t=>JSON.stringify(String(t||"")))(t));function h(t){if(!t)return"";return d([t.name||t.nombre||"",t.marca||t.brand||"",Array.isArray(t.tags)?t.tags.join(" "):"",Array.isArray(t.beneficios_bullet)?t.beneficios_bullet.join(" "):""].join(" "))}function v(){return window.Fuse&&"undefined"!=typeof PRODUCTS?c&&s===PRODUCTS?c:function(t){if(!window.Fuse||!Array.isArray(t)||!t.length)return null;const e=t.map(t=>({...t,__search_blob:h(t)}));return s=t,c=new window.Fuse(e,{includeScore:!0,threshold:.4,ignoreLocation:!0,minMatchCharLength:2,keys:["__search_blob"]}),c}(PRODUCTS):null}const b="function"==typeof window.isPackProduct?window.isPackProduct:t=>{if(!t)return!1;if(!0===t.es_pack||!0===t.is_pack)return!0;const e=t.packItems||t.pack_items||t.packItemsIds;return Array.isArray(e)&&e.length>0},w="undefined"!=typeof Set?new Set:[];let E=null,S=!1,C=null;const $=window.NB_BASE_PATH||"./";function _(t){if("Tab"!==t.key)return;const e=document.getElementById("cartModal");if(!e||!e.classList.contains("show"))return;const n=e.querySelectorAll('a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])');if(!n.length)return;const o=n[0],i=n[n.length-1];t.shiftKey&&document.activeElement===o?(t.preventDefault(),i.focus()):t.shiftKey||document.activeElement!==i||(t.preventDefault(),o.focus())}function T(t){return/\.webp(\?.*)?$/i.test(String(t||""))}function k(t,e={}){const n=g(function(t){return t?.image||t?.imagen_principal||l}(t)||l),o=g(function(t){const e=t?.imagen_principal_webp||t?.image_webp||"";return T(e)?e:""}(t)),i=f(e.alt||t?.name||t?.nombre||""),a=e.className?` class="${e.className}"`:"",r=e.loading?` loading="${e.loading}"`:"",c=' decoding="async"',s=`${e.width?` width="${e.width}"`:""}${e.height?` height="${e.height}"`:""}`,d=` onerror="this.onerror=null;this.src='${l}';"`;return o?`<picture><source srcset="${f(o)}" type="image/webp"><img src="${f(n)}" alt="${i}"${a}${r}${c}${s}${d}></picture>`:`<img src="${f(n)}" alt="${i}"${a}${r}${c}${s}${d}>`}function P(){return"function"==typeof window.checkoutWompi?Promise.resolve():C||(C=new Promise((t,e)=>{const n=document.createElement("script");n.src=`${$}static/js/wompi-estatico-completo.min.js`,n.defer=!0,n.onload=()=>t(),n.onerror=()=>e(new Error("Wompi load failed")),document.head.appendChild(n)}),C)}function A(t){if("function"!=typeof nbGa4EcomEvent||"function"!=typeof nbMapProductToGa4Item)return;if(!t)return;const e=t.id||t.item_id||t.product_id||null,n=null!==e?String(e):null;if(n)if(Array.isArray(w)){if(-1!==w.indexOf(n))return;w.push(n)}else{if("function"==typeof w.has&&w.has(n))return;"function"==typeof w.add&&w.add(n)}const o=nbMapProductToGa4Item(t,1);nbGa4EcomEvent("view_item",[o],o.price||0)}function L(){return"function"==typeof loadProductsData?loadProductsData().then(()=>{Array.isArray(window.PRODUCTS)&&(i="function"==typeof buildProductsMap?buildProductsMap(window.PRODUCTS):{})}):(Array.isArray(window.PRODUCTS)&&(i="function"==typeof buildProductsMap?buildProductsMap(window.PRODUCTS):{}),Promise.resolve("undefined"!=typeof PRODUCTS?PRODUCTS:[]))}function I(){let e=null;const n=p();if(n&&(e=n.getItem(m)),!e)try{e=window.sessionStorage?window.sessionStorage.getItem(m):null}catch(t){e=null}e&&(t=JSON.parse(e)),G()}function B(){const e=p();e&&e.setItem(m,JSON.stringify(t))}function O(e){const n=String(e),o=t.find(t=>String(t.id)===n)||null;if(t=t.filter(t=>String(t.id)!==n),B(),G(),o&&"function"==typeof nbGa4EcomEvent&&"function"==typeof nbMapProductToGa4Item){const t="undefined"!=typeof PRODUCTS?PRODUCTS.find(t=>t.id===o.id):null,e=t?{...t}:{...o},n=nbMapProductToGa4Item(e,o.quantity||1);nbGa4EcomEvent("remove_from_cart",[n],o.price||0)}}function q(){if(!r)return null;let t=document.getElementById("miniCart");if(t)return t;t=document.createElement("aside"),t.id="miniCart",t.className="mini-cart",t.setAttribute("aria-hidden","true"),t.innerHTML='\n        <div class="mini-cart-header">\n            <span>Carrito actualizado</span>\n            <button type="button" class="btn-ghost" data-mini-close>Cerrar</button>\n        </div>\n        <div class="mini-cart-body">\n            <p class="mini-cart-product" data-mini-product>Producto agregado</p>\n            <p><strong data-mini-count>0</strong> items Â· <strong data-mini-total>$0</strong></p>\n            <p class="mini-cart-shipping">EnvÃ­o $15.000 Â· Gratis desde $100.000.</p>\n        </div>\n        <div class="mini-cart-actions">\n            <button type="button" class="btn-primary" data-mini-view>Ver carrito</button>\n            <button type="button" class="btn-ghost" data-mini-continue>Seguir comprando</button>\n        </div>\n    ',document.body.appendChild(t);const e=t.querySelector("[data-mini-close]"),n=t.querySelector("[data-mini-view]"),o=t.querySelector("[data-mini-continue]");return e&&e.addEventListener("click",M),o&&o.addEventListener("click",M),n&&n.addEventListener("click",()=>{M(),U()}),t}function D(t,e){const n=e||q();if(!n)return;const o=N(),i=x(),a="function"==typeof formatCOP?formatCOP(o):`$${o.toLocaleString("es-CO")}`,r=n.querySelector("[data-mini-product]"),c=n.querySelector("[data-mini-count]"),s=n.querySelector("[data-mini-total]");r&&t&&(r.textContent=t),c&&(c.textContent=i),s&&(s.textContent=a)}function M(){const t=document.getElementById("miniCart");t&&(t.classList.remove("is-open"),t.setAttribute("aria-hidden","true"),u&&clearTimeout(u),u=null)}function R(){t=[],B(),G()}function N(){return t.reduce((t,e)=>t+e.price*e.quantity,0)}function x(){return t.reduce((t,e)=>t+e.quantity,0)}function G(){const e=document.querySelectorAll(".cart-badge"),n=document.getElementById("cartBody"),o=document.getElementById("cartFooter"),a=document.getElementById("cartTotal");if(!(e.length&&n&&o&&a))return;const r=x(),c=N(),s="function"==typeof computeCartSubtotal?computeCartSubtotal(t,i):c,d="function"==typeof getFreeShippingState?getFreeShippingState({subtotal:s,city:window.NB_SELECTED_CITY||""}):null;e.forEach(t=>{t.textContent=r,t.style.display=r>0?"flex":"none"});const u=document.getElementById("miniCart");if(u&&D(null,u),0===t.length)n.innerHTML='\n            <div class="cart-empty">\n                <div class="cart-empty-icon">ðŸ›’</div>\n                <h3>Tu carrito estÃ¡ vacÃ­o por ahora</h3>\n                <p>Agrega productos para comenzar tu compra</p>\n            </div>\n            <div id="shippingWidgetCartEmpty"></div>\n        ',o.style.display="none",d&&"function"==typeof renderShippingWidget&&renderShippingWidget(document.getElementById("shippingWidgetCartEmpty"),d,{compact:!1,showCityNote:!0});else{n.innerHTML=t.map(t=>{const e=y(t.id),n=f(t.name||"");return`\n            <div class="cart-item">\n                <img src="${f(g(t.image||l))}" alt="${n}" class="cart-item-image" loading="lazy" decoding="async" onerror="this.onerror=null;this.src='${l}';">\n                <div class="cart-item-info">\n                    <div class="cart-item-name">${n}</div>\n                    <div class="cart-item-price">$${t.price.toLocaleString("es-CO")}</div>\n                    <div class="cart-item-controls">\n                        <button class="cart-qty-btn" onclick="updateQuantity(${e}, -1)">-</button>\n                        <span class="cart-qty">${t.quantity}</span>\n                        <button class="cart-qty-btn" onclick="updateQuantity(${e}, 1)">+</button>\n                        <button class="cart-remove" onclick="removeFromCart(${e})">Eliminar</button>\n                    </div>\n                </div>\n            </div>\n        `}).join(""),o.style.display="block";let e=document.getElementById("shippingWidgetCart");e||(e=document.createElement("div"),e.id="shippingWidgetCart",o.insertBefore(e,o.firstChild)),d&&"function"==typeof renderShippingWidget&&renderShippingWidget(e,d,{compact:!1,showCityNote:!0});let i=document.getElementById("cartTrust");i||(i=document.createElement("div"),i.id="cartTrust",i.className="cart-trust",o.appendChild(i)),i.innerHTML='\n            <p class="cart-trust__title">Compra segura Natural Be</p>\n            <ul class="cart-trust__list">\n                <li>Pagos Wompi: tarjeta, PSE, Nequi y billeteras.</li>\n                <li>EnvÃ­o $15.000 Â· Gratis desde $100.000.</li>\n                <li>EnvÃ­o 24-48h con guÃ­a y soporte directo por WhatsApp.</li>\n                <li>Reemplazo o devoluciÃ³n si tu pedido llega con novedad.</li>\n            </ul>\n        '}a.textContent="function"==typeof formatCOP?formatCOP(c):`$${c.toLocaleString("es-CO")}`,d&&window.dispatchEvent(new CustomEvent("nb:cart-updated",{detail:{cart:[...t],subtotal:s,shipping:d}})),"function"==typeof addWompiButtonToCart&&addWompiButtonToCart(),j(t)}function U(){const e=document.getElementById("cartModal"),n=document.querySelector(".cart-float"),o=e?e.querySelector(".cart-content"):null;if(!e)return;const i=!e.classList.contains("show");e.classList.toggle("show",i),e.setAttribute("aria-hidden",i?"false":"true"),n&&n.setAttribute("aria-expanded",i?"true":"false"),i?(E=document.activeElement,"function"==typeof nbGa4EcomEvent&&nbGa4EcomEvent("view_cart",t,N()),document.body.style.overflow="hidden",j(t),o&&o.focus()):(document.body.style.overflow="auto",E&&"function"==typeof E.focus&&E.focus())}function W(t,e=3){if("undefined"==typeof PRODUCTS)return[];const n=new Set(t.map(t=>String(t.id))),o=PRODUCTS.filter(t=>n.has(String(t.id))),i=PRODUCTS.filter(t=>!n.has(String(t.id))&&!V(t)),a=[],r=new Set(n),c=t=>{for(const n of t){if(a.length>=e)break;const t=String(n.id);r.has(t)||(r.add(t),a.push(n))}},s=o.map(t=>{return e=t,d(e?.category||e?.categoria||"").replace(/[_-]+/g," ").trim();var e}).filter(Boolean),l=o.map(t=>h(t)).join(" "),u=s.some(t=>t.includes("cuidado")&&(t.includes("facial")||t.includes("piel")||t.includes("personal"))),m=l.includes("proteina"),p=t=>{const e=d(t).split(" ").filter(Boolean);return e.length?i.filter(t=>{const n=h(t);return e.every(t=>n.includes(t))}):[]};if(u&&c(p("bloqueador solar")),m&&c(p("creatina")),a.length<e){c(i.filter(t=>t.stock_bajo))}if(a.length<e){c(i.filter(t=>t.isPopular||String(t.badge||"").toLowerCase().includes("vendido")))}return a.length<e&&c(i),a.slice(0,e)}function j(t){const e=document.getElementById("recommendedContainer");if(!e)return;const n=W(t,3);if(!n||0===n.length)return void(e.style.display="none");e.style.display="block";const o=n.map(t=>{const e=y(t.id),n=f(t.name||""),o=y(t.name),i=y(t.image||l);return`\n                <div class="recommended-card">\n                    <div class="recommended-thumb">\n                        ${k(t,{alt:t.name,className:"recommended-thumb-image",loading:"lazy"})}\n                    </div>\n                    <div class="recommended-info">\n                        <div class="recommended-name">${n}</div>\n                        <div class="recommended-price">$${t.price.toLocaleString("es-CO")}</div>\n                        <button class="recommended-add" onclick="addToCart(${e}, ${o}, ${t.price}, ${i})" aria-label="Agregar ${n} al carrito">\n                            Agregar al carrito\n                        </button>\n                    </div>\n                </div>\n            `}).join("");e.innerHTML=`\n        <div class="recommended-header">\n            <h4>Te puede interesar</h4>\n            <p class="recommended-subtitle">Productos que combinan con tu compra</p>\n        </div>\n        <div class="recommended-grid">\n            ${o}\n        </div>\n    `,"function"==typeof logEvent&&logEvent("view_recommendations",{from:"cart_modal",count:n.length})}function H(t){const e=document.createElement("div");e.style.cssText="\n        position: fixed;\n        top: 100px;\n        right: 20px;\n        background: #2d8659;\n        color: white;\n        padding: 1rem 1.5rem;\n        border-radius: 10px;\n        box-shadow: 0 4px 20px rgba(0,0,0,0.2);\n        z-index: 10001;\n        animation: slideIn 0.3s ease-out;\n    ";const n=f(t||"");e.innerHTML=`\n        <strong>âœ” Agregado al carrito</strong><br>\n        <small>${n}</small>\n    `,document.body.appendChild(e),setTimeout(()=>{e.style.animation="slideOut 0.3s ease-out",setTimeout(()=>e.remove(),300)},3e3)}function F(t,e){return"low"===t?e<=3e4:"mid"===t?e>3e4&&e<=4e4:"high"!==t||e>4e4}function z(t=[]){const e=Array.isArray(t)?[...t]:[];return"price-asc"===a?e.sort((t,e)=>(t.price||0)-(e.price||0)):"price-desc"===a?e.sort((t,e)=>(e.price||0)-(t.price||0)):"new"===a?e.sort((t,e)=>Number(e.isNew||0)-Number(t.isNew||0)):e.sort((t,e)=>{const n=(t.isPopular?2:0)+(t.isNew?.5:0),o=(e.isPopular?2:0)+(e.isNew?.5:0);return n===o?(t.price||0)-(e.price||0):o-n})}function V(t){return!(!t||!(t.es_pack||t.es_2x1||t.isPack||"packs"===t.category||"2x1"===t.offerType))}function Q(t){const n=document.getElementById("productsGrid"),i=document.getElementById("noResults");if(!n)return;if(!t||0===t.length)return n.innerHTML="",void(i&&(i.style.display="block"));const a=t.filter(t=>!V(t));if(!a.length)return n.innerHTML="",void(i&&(i.style.display="block"));i&&(i.style.display="none");const r=a.map(t=>{const e=[],n=f(t.name||""),o=f(t.description||""),i=f(g(t.url||"#")),a=f(t.category||""),r=f(t.badgeLabel||""),c=f(String(null!=t.id?t.id:"")),s=y(t.name),d=y(t.image||l);t.isPopular&&e.push('<span class="badge badge-popular">Popular</span>'),t.isNew&&e.push('<span class="badge badge-new">Nuevo</span>'),t.badgeLabel&&!t.isPopular&&e.push(`<span class="badge badge-featured">${r}</span>`);const u=`$${t.price.toLocaleString("es-CO")}`,m=t.stock_bajo?'<div class="product-stock-note">Â¡Ãšltimas 5 unidades disponibles!</div>':"",p=`\n                <div class="price-block">\n                    <div class="price-current-row">\n                        <span class="price price-current">${u}</span>\n                    </div>\n                </div>\n            `;return`\n            <div class="product-card" data-category="${a}" data-product-id="${c}">\n                <div class="product-media">\n                    <div class="product-badges">\n                        ${e.join("")}\n                    </div>\n                    <a href="${i}" aria-label="Ver ${n}">\n                        ${k(t,{alt:t.name,className:"product-image",loading:"lazy"})}\n                    </a>\n                </div>\n        <div class="product-info">\n            <h3><a href="${i}">${n}</a></h3>\n            <p class="product-description">${o}</p>\n            \n            <div class="product-perks">\n                <span class="perk-chip">ðŸšš 24-48h</span>\n                <span class="perk-chip soft">Pagos Wompi</span>\n            </div>\n        \n            ${p}\n            ${m}\n            <div class="product-actions">\n                <button class="buy-button" onclick="addToCart(${y(t.id)}, ${s}, ${t.price}, ${d})">Agregar al carrito</button>\n                <a class="ghost-button" href="${i}">Ver detalles</a>\n            </div>\n                </div>\n            </div>\n        `}).join("");n.innerHTML=r;n.querySelectorAll(".product-card").forEach(t=>{const e=t.dataset.productId||t.getAttribute("data-product-id"),n=a.find(t=>String(t.id)===String(e));n&&t.addEventListener("click",function(){A(n)},{once:!0})});if("function"==typeof nbGa4EcomEvent){const t=a.reduce((t,e)=>t+(e.price||0),0);nbGa4EcomEvent("view_item_list",a,t,{item_list_name:o?`BÃºsqueda: ${o}`:e&&"all"!==e?`CategorÃ­a: ${e}`:"CatÃ¡logo",item_list_id:o?"busqueda":e&&"all"!==e?`categoria-${e}`:"catalogo"})}}function X(t){if("undefined"==typeof PRODUCTS)return[];const i=d("string"==typeof t?t:o),a=PRODUCTS.filter(t=>{if(V(t))return!1;const o="all"===e||t.category&&t.category.includes(e),i=F(n,t.price);return o&&i});let r=a;if(i){const t=function(t,e){const n=d(t||"");if(!n)return e;const o=v();if(!o)return null;const i=new Map(e.map(t=>[String(t.id),t]));return o.search(n).map(t=>i.get(String(t.item.id))).filter(Boolean)}(i,a);r=Array.isArray(t)?t:a.filter(t=>h(t).includes(i))}const c=z(r);return Q(c),"function"==typeof logEvent&&logEvent("filter_products",{category:e,priceRange:n,query:o}),c}function J(){const t=document.querySelectorAll(".filter-btn");t.forEach(n=>{n.addEventListener("click",n=>{t.forEach(t=>t.classList.remove("active")),n.target.classList.add("active"),e=n.target.getAttribute("data-category")||"all",X()})});const i=document.getElementById("productSearch");i&&(i.addEventListener("input",t=>{o=t.target.value.trim(),X(),function(t){const n=document.getElementById("searchSuggestions");if(!n)return;if(!t||t.length<2)return n.innerHTML="",void(n.style.display="none");const o=t.toLowerCase(),i="undefined"!=typeof PRODUCTS?PRODUCTS.filter(t=>!V(t)&&t.name.toLowerCase().includes(o)):[],a=Array.from(new Set("undefined"!=typeof PRODUCTS?PRODUCTS.filter(t=>!V(t)).map(t=>t.category).filter(Boolean):[])).filter(t=>t.toLowerCase().includes(o)&&"packs"!==t.toLowerCase()),r=[];if(i.forEach(t=>{r.push({type:"producto",label:t.name,url:t.url||"#",category:t.category})}),a.forEach(t=>{r.push({type:"categoria",label:`Ver todos los productos de ${t}`,category:t})}),!r.length)return n.innerHTML="",void(n.style.display="none");n.innerHTML=r.slice(0,8).map(t=>{const e=f(t.type||""),n=f(g(t.url||"")),o=f(t.category||""),i=f(t.label||"");return`<div class="search-suggestion" data-type="${e}" data-url="${n}" data-category="${o}" data-label="${i}">\n            ${"producto"===t.type?"ðŸ”Ž":"ðŸ“‚"} ${i}\n        </div>`}).join(""),n.style.display="block",n.querySelectorAll(".search-suggestion").forEach(t=>{t.addEventListener("click",()=>{const n=t.getAttribute("data-type"),o=t.getAttribute("data-label"),i=t.getAttribute("data-category"),a=t.getAttribute("data-url"),r=document.getElementById("productSearch")?.value||"";if("function"==typeof logEvent&&logEvent("search_select",{search_term:r,selected_type:n,selected_name:o}),"producto"===n&&a)window.location.href=a;else if("categoria"===n&&i){e=i;const t=document.querySelector(`.filter-btn[data-category="${i}"]`);t&&(document.querySelectorAll(".filter-btn").forEach(t=>t.classList.remove("active")),t.classList.add("active")),X(),Y()}})})}(o)}),i.addEventListener("keydown",t=>{if("Enter"===t.key){t.preventDefault();const e=X();"function"==typeof logEvent&&logEvent("search",{search_term:o,results_count:e.length}),"function"==typeof nbPushEcommerceEvent&&nbPushEcommerceEvent("search",{search_term:o,results_count:e.length}),Y()}}));const r=document.getElementById("priceRange");r&&r.addEventListener("change",t=>{n=t.target.value||"all",X()});const c=document.getElementById("sortBy");c&&c.addEventListener("change",t=>{a=t.target.value||"featured",X()});const s=document.getElementById("clearFilters");s&&s.addEventListener("click",()=>{e="all",n="all",o="",a="featured",i&&(i.value=""),r&&(r.value="all"),c&&(c.value="featured"),t.forEach(t=>t.classList.remove("active"));const s=document.querySelector('.filter-btn[data-category="all"]');s&&s.classList.add("active"),X(),Y()})}function K(){const t=document.querySelectorAll("[data-category-target]");t.length&&t.forEach(t=>{t.addEventListener("click",()=>{!function(t){e=t||"all";const n=document.querySelectorAll(".filter-btn");n.length&&n.forEach(t=>{const n=t.getAttribute("data-category")||"all";t.classList.toggle("active",n===e)}),X();const o=document.getElementById("productos");o&&o.scrollIntoView({behavior:"smooth",block:"start"})}(t.getAttribute("data-category-target"))})})}function Y(){const t=document.getElementById("searchSuggestions");t&&(t.innerHTML="",t.style.display="none")}"function"!=typeof window.checkoutWompi&&(window.checkoutWompi=function t(){P().then(()=>{window.checkoutWompi&&window.checkoutWompi!==t?window.checkoutWompi():alert("No pudimos cargar el pago. Intenta de nuevo.")}).catch(()=>{alert("No pudimos cargar el pago. Intenta de nuevo.")})});const Z=document.createElement("style");Z.textContent="\n    @keyframes slideIn {\n        from { transform: translateX(400px); opacity: 0; }\n        to { transform: translateX(0); opacity: 1; }\n    }\n    @keyframes slideOut {\n        from { transform: translateX(0); opacity: 1; }\n        to { transform: translateX(400px); opacity: 0; }\n    }\n",document.head.appendChild(Z),document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("productsGrid"),n=()=>L().then(()=>{e&&"undefined"!=typeof PRODUCTS&&(Q(z(PRODUCTS)),J(),function(){const t=document.getElementById("headerSearch");if(!t)return;const e=document.querySelector(".header-search-btn"),n=document.getElementById("productSearch"),o=document.getElementById("productos"),i=()=>{n&&(n.value=t.value,n.dispatchEvent(new Event("input",{bubbles:!0})))};t.addEventListener("input",i),t.addEventListener("keydown",t=>{"Enter"===t.key&&(t.preventDefault(),i(),o&&o.scrollIntoView({behavior:"smooth",block:"start"}))}),e&&e.addEventListener("click",()=>{i(),o&&o.scrollIntoView({behavior:"smooth",block:"start"})})}())}),o=window.requestIdleCallback||(t=>setTimeout(t,900));e?n().finally(()=>{K(),I()}):o(()=>{L().finally(()=>{K(),I()})}),document.addEventListener("click",function(e){if(!(e.target&&e.target.closest?e.target.closest(".alt-payment-btn, #wompiCheckoutBtn"):null))return;e.preventDefault();const n=N();"function"==typeof logEvent&&logEvent("checkout_wompi_click",{source:"widget",total:n,items:t}),P().then(()=>{"function"==typeof checkoutWompi?checkoutWompi():console.warn("checkoutWompi no disponible")}).catch(()=>{alert("No pudimos cargar el pago. Intenta de nuevo.")})},{passive:!1}),document.addEventListener("click",t=>{const e=document.querySelector(".search-wrapper");e&&(e.contains(t.target)||Y())});const i=document.getElementById("subscribeForm");i&&i.addEventListener("submit",function(t){t.preventDefault();const e=document.getElementById("subName")?.value.trim(),n=document.getElementById("subEmail")?.value.trim(),o=document.getElementById("subPhone")?.value.trim(),a=document.getElementById("subConsent")?.checked,r=document.getElementById("subMessage");e&&n&&a?(r&&(r.textContent="?Gracias por suscribirte!"),r&&(r.style.animation="messageBounce 0.6s ease"),setTimeout(()=>{r&&(r.style.animation="none")},700),i.reset(),"function"==typeof nbPushEcommerceEvent&&nbPushEcommerceEvent("generate_lead",{name:e,has_email:!!n,has_phone:!!o}),"function"==typeof logEvent&&logEvent("generate_lead",{name:e,has_email:!!n,has_phone:!!o})):r&&(r.textContent="Por favor completa nombre, email y acepta la polÃ­tica.")})}),document.addEventListener("DOMContentLoaded",G),document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("cartModal");t&&t.setAttribute("aria-hidden","true"),document.addEventListener("keydown",e=>{"Escape"===e.key&&t&&t.classList.contains("show")&&U()}),S||(document.addEventListener("keydown",_),S=!0)}),window.addToCart=function(e,n,o,i){const a=String(e),c="undefined"!=typeof PRODUCTS?PRODUCTS.find(t=>String(t.id)===a):null,s=c?{...c}:{id:e,name:n,price:o,image:i},d=Array.isArray(s.packItems)?s.packItems:[],l=t.find(t=>String(t.id)===a);if(l?l.quantity+=1:t.push({id:a,name:n,price:o,image:i,quantity:1}),B(),G(),H(n),function(t){if(!r)return;const e=q();if(!e)return;D(t),e.classList.add("is-open"),e.setAttribute("aria-hidden","false"),u&&clearTimeout(u);u=setTimeout(()=>{M()},5e3)}(n),"function"==typeof nbGa4EcomEvent&&"function"==typeof nbMapProductToGa4Item){const t=b(s),e=[nbMapProductToGa4Item({...s,item_category:s.category||(t?"packs":null)},1)];t&&Array.isArray(d)&&d.forEach(t=>{const n="undefined"!=typeof PRODUCTS?PRODUCTS.find(e=>e.id===t):null;n&&e.push(nbMapProductToGa4Item({...n,price:0,item_category:"pack_component"},1))}),nbGa4EcomEvent("add_to_cart",e,o)}},window.buildCartEcomItems=function(t){return"function"==typeof buildEcommerceItems?buildEcommerceItems(t.map(t=>({...t}))):t.map(t=>({item_id:t.id,item_name:t.name,item_category:t.category||null,price:t.price,quantity:t.quantity||1,image:t.image||""}))},window.checkoutWhatsApp=function(){if(0===t.length)return void("function"==typeof window.showToast?window.showToast("Tu carrito estÃ¡ vacÃ­o por ahora","error"):alert("Tu carrito estÃ¡ vacÃ­o por ahora"));const e=document.querySelector('[onclick*="checkoutWhatsApp"]');e&&(e.disabled=!0,e.textContent="Preparando pedido...");const n=N();let o="Hola! ðŸ‘‹ Quisiera armar mi pedido con estos productos:%0A%0A";t.forEach(t=>{o+=`*${t.name}*%0A`,o+=`Cantidad: ${t.quantity}%0A`,o+=`Precio: $${t.price.toLocaleString("es-CO")}%0A`,o+=`Subtotal: $${(t.price*t.quantity).toLocaleString("es-CO")}%0A%0A`}),o+=`*TOTAL: $${n.toLocaleString("es-CO")}*%0A%0A`,o+="Â¿Me ayudas a confirmar disponibilidad y costo de envÃ­o?","function"==typeof logEvent&&logEvent("begin_checkout_whatsapp",{total:n,items:t}),"function"==typeof nbGa4EcomEvent&&(nbGa4EcomEvent("begin_checkout",t,n,{method:"whatsapp"}),nbGa4EcomEvent("add_shipping_info",t,n,{method:"whatsapp"}),nbGa4EcomEvent("add_payment_info",t,n,{method:"whatsapp"})),"function"==typeof window.showToast&&window.showToast("Abriendo WhatsApp con tu pedido...","success"),window.open(`https://wa.me/573137212923?text=${o}&utm_source=naturalbe&utm_medium=website&utm_campaign=retail&utm_content=checkout_whatsapp`,"_blank"),setTimeout(()=>{e&&(e.disabled=!1,e.textContent="Finalizar por WhatsApp")},2e3)},window.clearCart=function(){confirm("Â¿Quieres vaciar tu carrito por ahora?")&&R()},window.clearCartForce=R,window.closeCartOnOutsideClick=function(t){"cartModal"===t.target.id&&U()},window.filterProductsAdvanced=X,window.getCartItemCount=x,window.getCartTotal=N,window.getPriceFilter=F,window.getRecommendedProducts=W,window.isWebpSource=T,window.loadCart=I,window.removeFromCart=O,window.renderProducts=Q,window.renderRecommended=j,window.saveCart=B,window.setupFilters=J,window.showCartNotification=H,window.toggleCart=U,window.updateCartUI=G,window.updateQuantity=function(e,n){const o=String(e),i=t.find(t=>String(t.id)===o);if(i)if(i.quantity+=n,i.quantity<=0)O(e);else if(B(),G(),n<0&&"function"==typeof nbGa4EcomEvent&&"function"==typeof nbMapProductToGa4Item){const t="undefined"!=typeof PRODUCTS?PRODUCTS.find(t=>String(t.id)===String(i.id)):null,e=t?{...t}:{...i},o=nbMapProductToGa4Item(e,Math.abs(n));nbGa4EcomEvent("remove_from_cart",[o],i.price||0)}}})();