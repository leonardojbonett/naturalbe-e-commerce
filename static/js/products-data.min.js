(function(){const S=["./static/data/productos.json","/static/data/productos.json"],B="1",G="./static/img/placeholder.webp",h=[{id:"1001",slug:"colageno-hidrolizado-500mg",nombre:"Colageno Hidrolizado 500mg",marca:"Natural Be",categoria:"colageno",precio:25e3,tags:["piel","articulaciones"],descripcion_corta:"Colageno para piel y articulaciones."},{id:"1002",slug:"omega-3-1000mg",nombre:"Omega 3 1000mg",marca:"Natural Be",categoria:"omega",precio:4e4,tags:["corazon","cerebro"],descripcion_corta:"EPA/DHA para salud cardiovascular."},{id:"1003",slug:"biotina-5000mcg",nombre:"Biotina 5000mcg",marca:"Natural Be",categoria:"vitaminas",precio:28e3,tags:["cabello","unas"],descripcion_corta:"Biotina para cabello y unas."},{id:"1004",slug:"magnesio-quelado",nombre:"Magnesio Quelado",marca:"Natural Be",categoria:"minerales",precio:32e3,tags:["estres","sueno"],descripcion_corta:"Apoyo para relajacion y descanso."},{id:"1005",slug:"vitamina-c-zinc",nombre:"Vitamina C + Zinc",marca:"Natural Be",categoria:"inmunidad",precio:3e4,tags:["defensas"],descripcion_corta:"Refuerzo diario para inmunidad."},{id:"1006",slug:"ginseng-energia",nombre:"Ginseng Energia",marca:"Natural Be",categoria:"energia",precio:35e3,tags:["energia","rendimiento"],descripcion_corta:"Energia sostenida para el dia."},{id:"1007",slug:"multivitaminico-diario",nombre:"Multivitaminico Diario",marca:"Natural Be",categoria:"vitaminas",precio:45e3,tags:["energia"],descripcion_corta:"Vitaminas esenciales para la rutina."},{id:"1008",slug:"omega-3-epa-dha",nombre:"Omega 3 EPA DHA",marca:"Natural Be",categoria:"omega",precio:42e3,tags:["corazon"],descripcion_corta:"Soporte cardiovascular premium."},{id:"1009",slug:"colageno-mas-biotina",nombre:"Colageno + Biotina",marca:"Natural Be",categoria:"colageno",precio:38e3,tags:["piel","cabello"],descripcion_corta:"Formula para piel y cabello."},{id:"1010",slug:"zinc-picolinato",nombre:"Zinc Picolinato",marca:"Natural Be",categoria:"minerales",precio:26e3,tags:["inmunidad"],descripcion_corta:"Zinc de alta absorcion."}];let t=null;function w(a){if(!a)return null;const n=Number(a.precio||a.price||0),i=a.precio_oferta!=null&&!isNaN(a.precio_oferta),o=i?Number(a.precio_oferta):null,e=a.categoria||a.category||"otros",L=a.product_id||a.productId||"",c=a.slug||"",s=window.location&&window.location.protocol==="file:",l=s?"./":window.NB_BASE_PATH||(window.location&&window.location.pathname?window.location.pathname.replace(/[^/]*$/,"/"):"/"),p=s?"./static/img/placeholder.webp":`${l.replace(/\/?$/,"/")}static/img/placeholder.webp`,A=r=>{if(!r)return"";if(/^https?:\/\//i.test(r)||/^[a-zA-Z]:[\\/]/.test(r))return r;if(s&&r.startsWith("/"))return`.${r}`;if(r.startsWith("//"))return`/${r.replace(/^\/+/,"")}`;if(r.startsWith("/"))return r;const U=String(r).replace(/^\.?\//,"");return`${l}${U}`},d=A(a.imagen_principal||a.image||p||""),C=A(a.imagen_principal_webp||(/\.(webp)(\?.*)?$/i.test(d)?d:"")||""),N=/\.webp(\?.*)?$/i.test(C)?C:"",R=d||p||"",u=(a.badge||"").toString(),g=u.toLowerCase(),_=!!(a.isPopular||g.includes("vendido")||g.includes("popular")),E=!!(a.isNew||g.includes("nuevo")),m=!!a.es_pack,O=Array.isArray(a.pack_items)?a.pack_items.map(String):Array.isArray(a.packItems)?a.packItems.map(String):[];return{id:a.id!=null?String(a.id):"",slug:c,nombre:a.nombre||a.name||"",marca:a.marca||a.proveedor||"Natural Be",categoria:e,subcategoria:a.subcategoria||null,presentacion:a.presentacion||"",precio:n,precio_oferta:o,moneda:a.moneda||"COP",es_pack:m,es_2x1:!!a.es_2x1,pack_items:O,packItems:O,tags:a.tags||[],beneficios_bullet:a.beneficios_bullet||a.beneficios||[],descripcion_corta:a.descripcion_corta||a.description||"",descripcion_larga:a.descripcion_larga||"",dosis_recomendada:a.dosis_recomendada||a.modo_uso||"",imagen_principal:R,imagen_principal_webp:N,disponible:a.disponible!==!1,badge:u||(_?"mas vendido":null),badgeLabel:u||(_?"Mas vendido":null),isPopular:_,isNew:E,isPack:m,stock_bajo:!!a.stock_bajo,seo_title:a.seo_title||"",seo_description:a.seo_description||"",rating_value:Number(a.rating_value||0),rating_count:Number(a.rating_count||0),url:a.url||a.link||(c?`${l}product.html?slug=${c}`:"/product.html"),product_id:L,name:a.nombre||a.name||"",price:n,offerType:a.es_2x1?"2x1":m?"pack":null,discountPercent:i&&n?Math.max(0,Math.round((1-o/n)*100)):0,image:R,description:a.descripcion_corta||a.description||"",category:e,raw:a}}function f(){return h.map(w).filter(Boolean)}function P(){return window.NB_DATA_VERSION||B}function T(){const a=P();return S.map(n=>`${n}?v=${a}`)}async function D(a){let n=null;for(const i of a)try{const o=await fetch(i,{cache:"force-cache"});if(!o.ok)throw new Error(`Catalog fetch failed: ${o.status}`);const e=await o.json();if(!Array.isArray(e))throw new Error("Catalog payload is not an array");return e}catch(o){n=o}throw n||new Error("Catalog fetch failed")}async function b(a={}){if(t&&!a.force)return t;if(a.force&&(t=null),window.location&&window.location.protocol==="file:"){const i=f();return window.NB_CATALOG_ERROR=!0,window.NB_CATALOG_SOURCE="fallback",window.NB_CATALOG_ERROR_MESSAGE="Catalogo no disponible en file://",window.ALL_PRODUCTS=i,window.PRODUCTS=i,window.PRODUCTS_BY_ID={},window.PRODUCTS_BY_SLUG={},i.forEach(o=>{o.id&&(window.PRODUCTS_BY_ID[o.id]=o),o.slug&&(window.PRODUCTS_BY_SLUG[o.slug]=o)}),Promise.resolve(i)}const n=T();return t=D(n).then(i=>i.map(w).filter(Boolean)).then(i=>(window.NB_CATALOG_ERROR=!1,window.NB_CATALOG_SOURCE="remote",window.NB_CATALOG_ERROR_MESSAGE="",window.ALL_PRODUCTS=i,window.PRODUCTS=i,window.PRODUCTS_BY_ID={},window.PRODUCTS_BY_SLUG={},i.forEach(o=>{o.id&&(window.PRODUCTS_BY_ID[o.id]=o),o.slug&&(window.PRODUCTS_BY_SLUG[o.slug]=o)}),i)).catch(i=>{console.error("Error cargando catalogo",i);const o=f();return window.NB_CATALOG_ERROR=!0,window.NB_CATALOG_SOURCE="fallback",window.NB_CATALOG_ERROR_MESSAGE="No pudimos cargar el catalogo.",window.ALL_PRODUCTS=o,window.PRODUCTS=o,window.PRODUCTS_BY_ID={},window.PRODUCTS_BY_SLUG={},o.forEach(e=>{e.id&&(window.PRODUCTS_BY_ID[e.id]=e),e.slug&&(window.PRODUCTS_BY_SLUG[e.slug]=e)}),o}),t}window.loadProductsData=b,window.retryCatalogLoad=function(){return b({force:!0})}})();
